
drop table datos_sarlaf_n_ext;

-- Create table
create table DATOS_SARLAF_N_EXT
(
  itomador                 VARCHAR2(1000),
  ntomador                 VARCHAR2(1000),
  ide_tomador              VARCHAR2(1000),
  fecha_dilimiento_cb      VARCHAR2(1000),
  departamento_cb          VARCHAR2(1000),
  ciudad_cb                VARCHAR2(1000),
  sucursal_cb              VARCHAR2(1000),
  tipo_solicitud_cb        VARCHAR2(1000),
  clase_vin_cb             VARCHAR2(1000),
  clase_otro_cb            VARCHAR2(1000),
  tomador_aseg_cb          VARCHAR2(1000),
  ase_otro_cb              VARCHAR2(1000),
  tomador_bene_cb          VARCHAR2(1000),
  bene_otro_cb             VARCHAR2(1000),
  asegu_beneficiario_cb    VARCHAR2(1000),
  ase_ben_otro_cb          VARCHAR2(1000),
  primer_apellido_ib       VARCHAR2(1000),
  segundo_apellido_ib      VARCHAR2(1000),
  nombres_ib               VARCHAR2(1000),
  tipo_documento_ib        VARCHAR2(1000),
  numero_ib                VARCHAR2(1000),
  fecha_expedicion_ib      VARCHAR2(1000),
  pais_exped_ib            VARCHAR2(1000),
  depart_exped_ib          VARCHAR2(1000),
  lugar_expedicion_ib      VARCHAR2(1000),
  fecha_nacimiento_ib      VARCHAR2(1000),
  pais_lugar_naci_ib       VARCHAR2(1000),
  depart_lugar_naci_ib     VARCHAR2(1000),
  lugar_nacimiento_ib      VARCHAR2(1000),
  nacionalidad1_ib         VARCHAR2(1000),
  nacionalidad2_ib         VARCHAR2(1000),
  direccion_residencia_ib  VARCHAR2(1000),
  ciiu_actividad_ib        VARCHAR2(1000),
  ciiu_cod_ib              VARCHAR2(1000),
  sector_ib                VARCHAR2(1000),
  tipo_actividad_ib        VARCHAR2(1000),
  pais_residencia_ib       VARCHAR2(1000),
  dep_residencia_ib        VARCHAR2(1000),
  ciudad_residencia_ib     VARCHAR2(1000),
  telefono_residencia_ib   VARCHAR2(1000),
  celular_ib               VARCHAR2(1000),
  email_ib                 VARCHAR2(1000),
  ocupacion_ib             VARCHAR2(1000),
  cargo_ib                 VARCHAR2(1000),
  emp_tra_pn_ib            VARCHAR2(1000),
  dir_emp_pn_ib            VARCHAR2(1000),
  dep_empresa_pn_ib        VARCHAR2(1000),
  ciuda_emp_pn_ib          VARCHAR2(1000),
  tele_empresa_pn_ib       VARCHAR2(1000),
  act_sec_pn_ib            VARCHAR2(1000),
  ciiu_sec_pn_ib           VARCHAR2(1000),
  producto_servicio_ib     VARCHAR2(1000),
  usted_sujeto_ib          VARCHAR2(1000),
  usted_una_ib             VARCHAR2(1000),
  existe_vinculo_ib        VARCHAR2(1000),
  por_cargo_ib             VARCHAR2(1000),
  vinculo_relacion_1_pep   VARCHAR2(1000),
  nombre_completo_1_pep    VARCHAR2(1000),
  tipo_iden_1_pep          VARCHAR2(1000),
  numero_iden_1_pep        VARCHAR2(1000),
  nacionalidad_1_pep       VARCHAR2(1000),
  entidad_1_pep            VARCHAR2(1000),
  cargo_1_pep              VARCHAR2(1000),
  fecha_desvin_1_pep       VARCHAR2(1000),
  vinculo_relacion_2_pep   VARCHAR2(1000),
  nombre_completo_2_pep    VARCHAR2(1000),
  tipo_iden_2_pep          VARCHAR2(1000),
  numero_iden_2_pep        VARCHAR2(1000),
  nacionalidad_2_pep       VARCHAR2(1000),
  entidad_2_pep            VARCHAR2(1000),
  cargo_2_pep              VARCHAR2(1000),
  fecha_desvin_2_pep       VARCHAR2(1000),
  vinculo_relacion_3_pep   VARCHAR2(1000),
  nombre_completo_3_pep    VARCHAR2(1000),
  tipo_iden_3_pep          VARCHAR2(1000),
  numero_iden_3_pep        VARCHAR2(1000),
  nacionalidad_3_pep       VARCHAR2(1000),
  entidad_3_pep            VARCHAR2(1000),
  cargo_3_pep              VARCHAR2(1000),
  fecha_desvin_3_pep       VARCHAR2(1000),
  vinculo_relacion_4_pep   VARCHAR2(1000),
  nombre_completo_4_pep    VARCHAR2(1000),
  tipo_iden_4_pep          VARCHAR2(1000),
  numero_iden_4_pep        VARCHAR2(1000),
  nacionalidad_4_pep       VARCHAR2(1000),
  entidad_4_pep            VARCHAR2(1000),
  cargo_4_pep              VARCHAR2(1000),
  fecha_desvin_4_pep       VARCHAR2(1000),
  ingresos_mensuales_ib    VARCHAR2(1000),
  egresos_mensuales_ib     VARCHAR2(1000),
  activos_ib               VARCHAR2(1000),
  pasivos_ib               VARCHAR2(1000),
  patrimonio_ib            VARCHAR2(1000),
  otros_ingresos_ib        VARCHAR2(1000),
  con_otr_ing_ib           VARCHAR2(1000),
  declar_fondos_df         VARCHAR2(1000),
  realiza_transacciones_oi VARCHAR2(1000),
  si_cual_oi               VARCHAR2(1000),
  otras_indique_oi         VARCHAR2(1000),
  posee_productos_oi       VARCHAR2(1000),
  poseee_cuentas_oi        VARCHAR2(1000),
  tipo_producto_oi         VARCHAR2(1000),
  id_num_producto_oi       VARCHAR2(1000),
  entidad_producto_oi      VARCHAR2(1000),
  monto_oi                 VARCHAR2(1000),
  pais_oi                  VARCHAR2(1000),
  departmento_oi           VARCHAR2(1000),
  ciudad_oi                VARCHAR2(1000),
  moneda_oi                VARCHAR2(1000),
  pre_reclamacion_rs       VARCHAR2(1000),
  ano_rs                   VARCHAR2(1000),
  ramo_rs                  VARCHAR2(1000),
  compania_rs              VARCHAR2(1000),
  valor_rs                 VARCHAR2(1000),
  resultado_rs             VARCHAR2(1000),
  autoriza_1_ca            VARCHAR2(1000),
  autoriza_2_ca            VARCHAR2(1000),
  estado_confirmacion_ci   VARCHAR2(1000),
  fecha_confirmacion_ci    VARCHAR2(1000),
  actividad_principal_ib   VARCHAR2(1000),
  fecha_entrevista_ie      VARCHAR2(1000),
  resultado_ie             VARCHAR2(1000)
)
organization external
(
  type ORACLE_LOADER
  default directory TABEXT
  access parameters 
  (
    records delimited by 0x'0A'
     logfile 'BACTH NATURAL3.log'
     badfile 'BACTH NATURAL3.bad'
     discardfile 'BACTH NATURAL3.dis'
     fields terminated by '|' lrtrim
     MISSING FIELD VALUES ARE NULL
     REJECT ROWS WITH ALL NULL FIELDS
     (
        itomador,
        ntomador,
        ide_tomador,
        fecha_dilimiento_cb,
        departamento_cb,
        ciudad_cb,
        sucursal_cb,
        tipo_solicitud_cb,
        clase_vin_cb,
        clase_otro_cb,
        tomador_aseg_cb,
        ase_otro_cb,
        tomador_bene_cb,
        bene_otro_cb,
        asegu_beneficiario_cb,
        ase_ben_otro_cb,
        primer_apellido_ib,
        segundo_apellido_ib,
        nombres_ib,
        tipo_documento_ib,
        numero_ib,
        fecha_expedicion_ib,
        pais_exped_ib,
        depart_exped_ib,
        lugar_expedicion_ib,
        fecha_nacimiento_ib,
        pais_lugar_naci_ib,
        depart_lugar_naci_ib,
        lugar_nacimiento_ib,
        nacionalidad1_ib,
        nacionalidad2_ib,
        direccion_residencia_ib,
        ciiu_actividad_ib,
        ciiu_cod_ib,
        sector_ib,
        tipo_actividad_ib,
        pais_residencia_ib,
        dep_residencia_ib,
        ciudad_residencia_ib,
        telefono_residencia_ib,
        celular_ib,
        email_ib,
        ocupacion_ib,
        cargo_ib,
        emp_tra_pn_ib,
        dir_emp_pn_ib,
        dep_empresa_pn_ib,
        ciuda_emp_pn_ib,
        tele_empresa_pn_ib,
        act_sec_pn_ib,
        ciiu_sec_pn_ib,
        producto_servicio_ib,
        usted_sujeto_ib,
        usted_una_ib,
        existe_vinculo_ib,
        por_cargo_ib,
        vinculo_relacion_1_pep,
        nombre_completo_1_pep,
        tipo_iden_1_pep,
        numero_iden_1_pep,
        nacionalidad_1_pep,
        entidad_1_pep,
        cargo_1_pep,
        fecha_desvin_1_pep,
        vinculo_relacion_2_pep,
        nombre_completo_2_pep,
        tipo_iden_2_pep,
        numero_iden_2_pep,
        nacionalidad_2_pep,
        entidad_2_pep,
        cargo_2_pep,
        fecha_desvin_2_pep,
        vinculo_relacion_3_pep,
        nombre_completo_3_pep,
        tipo_iden_3_pep,
        numero_iden_3_pep,
        nacionalidad_3_pep,
        entidad_3_pep,
        cargo_3_pep,
        fecha_desvin_3_pep,
        vinculo_relacion_4_pep,
        nombre_completo_4_pep,
        tipo_iden_4_pep,
        numero_iden_4_pep,
        nacionalidad_4_pep,
        entidad_4_pep,
        cargo_4_pep,
        fecha_desvin_4_pep,
        ingresos_mensuales_ib,
        egresos_mensuales_ib,
        activos_ib,
        pasivos_ib,
        patrimonio_ib,
        otros_ingresos_ib,
        con_otr_ing_ib,
        declar_fondos_df,
        realiza_transacciones_oi,
        si_cual_oi,
        otras_indique_oi,
        posee_productos_oi,
        poseee_cuentas_oi,
        tipo_producto_oi,
        id_num_producto_oi,
        entidad_producto_oi,
        monto_oi,
        pais_oi,
        departmento_oi,
        ciudad_oi,
        moneda_oi,
        pre_reclamacion_rs,
        ano_rs,
        ramo_rs,
        compania_rs,
        valor_rs,
        resultado_rs,
        autoriza_1_ca,
        autoriza_2_ca,
        estado_confirmacion_ci,
        fecha_confirmacion_ci,
        ACTIVIDAD_PRINCIPAL_IB,
        FECHA_ENTREVISTA_IE,
        RESULTADO_IE
    )
  )
  location (TABEXT:'BACTH NATURAL3.csv')
)
reject limit UNLIMITED;


alter table DATOS_SARLAF_N drop column cuales_ib;
alter table DATOS_SARLAF_N add ACTIVIDAD_PRINCIPAL_IB VARCHAR2(1000);
alter table DATOS_SARLAF_N add FECHA_ENTREVISTA_IE VARCHAR2(1000);
alter table DATOS_SARLAF_N add RESULTADO_IE VARCHAR2(1000);

--Grant 
grant select on AXIS.DATOS_SARLAF_N_EXT to AXIS00;


-- Utilizar para crear synonym

create or replace synonym AXIS.DATOS_SARLAF_N_EXT for AXIS00.DATOS_SARLAF_N_EXT;
