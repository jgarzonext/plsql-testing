
drop table DATOS_SARLAF_J_EXT;

-- Create table
create table DATOS_SARLAF_J_EXT
(
  itomador                   VARCHAR2(1000),
  ntomador                   VARCHAR2(1000),
  fecha_dilimiento_cb        VARCHAR2(1000),
  departamento_cb            VARCHAR2(1000),
  ciudad_cb                  VARCHAR2(1000),
  sucursal_cb                VARCHAR2(1000),
  tipo_solicitud_cb          VARCHAR2(1000),
  clase_vin_cb               VARCHAR2(1000),
  clase_otro_cb              VARCHAR2(1000),
  residencia_sociedad_cb     VARCHAR2(1000),
  tomador_aseg_cb            VARCHAR2(1000),
  asegurado_otro_cb          VARCHAR2(1000),
  tomador_bene_cb            VARCHAR2(1000),
  beneficiario_otro_cb       VARCHAR2(1000),
  asegu_beneficiario_cb      VARCHAR2(1000),
  beneficiario_ase_otro_cb   VARCHAR2(1000),
  nrazon_social_ib           VARCHAR2(1000),
  tipo_documento_ib          VARCHAR2(1000),
  nit_ib                     VARCHAR2(1000),
  dv_ib                      VARCHAR2(1000),
  tipo_empresa_ib            VARCHAR2(1000),
  ciiu_acti_economica_ib     VARCHAR2(1000),
  ciiu_cod_ib                VARCHAR2(1000),
  sector_ib                  VARCHAR2(1000),
  direccion_oficina_ib       VARCHAR2(1000),
  pais_oficina_ib            VARCHAR2(1000),
  dep_oficina_ib             VARCHAR2(1000),
  ciudad_oficina_ib          VARCHAR2(1000),
  telefono_oficina_ib        VARCHAR2(1000),
  email_ib                   VARCHAR2(1000),
  pais_sucursal_ib           VARCHAR2(1000),
  depart_sucursal_ib         VARCHAR2(1000),
  ciudad_sucursal_ib         VARCHAR2(1000),
  direccion_sucursal_ib      VARCHAR2(1000),
  telefono_sucursal_ib       VARCHAR2(1000),
  primer_apellido_rl         VARCHAR2(1000),
  segundo_apellido_rl        VARCHAR2(1000),
  legal_nombres_rl           VARCHAR2(1000),
  tipo_rl                    VARCHAR2(1000),
  numero_rl                  VARCHAR2(1000),
  fecha_exp_rl               VARCHAR2(1000),
  pais_exped_rl              VARCHAR2(1000),
  depart_exped_rl            VARCHAR2(1000),
  lugar_exp_rl               VARCHAR2(1000),
  fecha_naci_rl              VARCHAR2(1000),
  pais_lugar_naci_rl         VARCHAR2(1000),
  depart_lugar_naci_rl       VARCHAR2(1000),
  lugar_naci_rl              VARCHAR2(1000),
  naci_1rl                   VARCHAR2(1000),
  naci_2rl                   VARCHAR2(1000),
  email_rl                   VARCHAR2(1000),
  direccion_resid_rl         VARCHAR2(1000),
  pais_resid_rl              VARCHAR2(1000),
  departamento_resid_rl      VARCHAR2(1000),
  ciudad_resid_rl            VARCHAR2(1000),
  telefono_rl                VARCHAR2(1000),
  celular_rl                 VARCHAR2(1000),
  algunos_rl                 VARCHAR2(1000),
  por_cargo_rl               VARCHAR2(1000),
  es_usted_rl                VARCHAR2(1000),
  indique_cual_rl            VARCHAR2(1000),
  a1_tipo_id                 VARCHAR2(1000),
  a1_numero_id               VARCHAR2(1000),
  a1_nombres                 VARCHAR2(1000),
  a1_participacion           VARCHAR2(1000),
  a1_espersona               VARCHAR2(1000),
  a1_per_publicam            VARCHAR2(1000),
  a1_sujeto                  VARCHAR2(1000),
  a2_tipo_id                 VARCHAR2(1000),
  a2_numero_id               VARCHAR2(1000),
  a2_nombres                 VARCHAR2(1000),
  a2_participacion           VARCHAR2(1000),
  a2_espersona               VARCHAR2(1000),
  a2_per_publicam            VARCHAR2(1000),
  a2_sujeto                  VARCHAR2(1000),
  a3_tipo_id                 VARCHAR2(1000),
  a3_numero_id               VARCHAR2(1000),
  a3_nombres                 VARCHAR2(1000),
  a3_participacion           VARCHAR2(1000),
  a3_espersona               VARCHAR2(1000),
  a3_per_publicam            VARCHAR2(1000),
  a3_sujeto                  VARCHAR2(1000),
  a4_tipo_id                 VARCHAR2(1000),
  a4_numero_id               VARCHAR2(1000),
  a4_nombres                 VARCHAR2(1000),
  a4_participacion           VARCHAR2(1000),
  a4_espersona               VARCHAR2(1000),
  a4_per_publicam            VARCHAR2(1000),
  a4_sujeto                  VARCHAR2(1000),
  a5_tipo_id                 VARCHAR2(1000),
  a5_numero_id               VARCHAR2(1000),
  a5_nombres                 VARCHAR2(1000),
  a5_participacion           VARCHAR2(1000),
  a5_espersona               VARCHAR2(1000),
  a5_per_publicam            VARCHAR2(1000),
  a5_sujeto                  VARCHAR2(1000),
  vinculo1_relacion_pep      VARCHAR2(1000),
  nombre1_completo_pep       VARCHAR2(1000),
  tipo1_identificacion_pep   VARCHAR2(1000),
  numero1_identificacion_pep VARCHAR2(1000),
  nacionalidad1_pep          VARCHAR2(1000),
  entidad1_pep               VARCHAR2(1000),
  cargo1_pep                 VARCHAR2(1000),
  fecha1_desvinculacion_pep  VARCHAR2(1000),
  vinculo2_relacion_pep      VARCHAR2(1000),
  nombre2_completo_pep       VARCHAR2(1000),
  tipo2_identificacion_pep   VARCHAR2(1000),
  numero2_identificacion_pep VARCHAR2(1000),
  nacionalidad2_pep          VARCHAR2(1000),
  entidad2_pep               VARCHAR2(1000),
  cargo2_pep                 VARCHAR2(1000),
  fecha2_desvinculacion_pep  VARCHAR2(1000),
  vinculo3_relacion_pep      VARCHAR2(1000),
  nombre3_completo_pep       VARCHAR2(1000),
  tipo3_identificacion_pep   VARCHAR2(1000),
  numero3_identificacion_pep VARCHAR2(1000),
  nacionalidad3_pep          VARCHAR2(1000),
  entidad3_pep               VARCHAR2(1000),
  cargo3_pep                 VARCHAR2(1000),
  fecha3_desvinculacion_pep  VARCHAR2(1000),
  vinculo4_relacion_pep      VARCHAR2(1000),
  nombre4_completo_pep       VARCHAR2(1000),
  tipo4_identificacion_pep   VARCHAR2(1000),
  numero4_identificacion_pep VARCHAR2(1000),
  nacionalidad4_pep          VARCHAR2(1000),
  entidad4_pep               VARCHAR2(1000),
  cargo4_pep                 VARCHAR2(1000),
  fecha4_desvinculacion_pep  VARCHAR2(1000),
  numero1_id_bf              VARCHAR2(1000),
  nombres1_bf                VARCHAR2(1000),
  nombre1_razonsocial_bf     VARCHAR2(1000),
  tipo1_id_bf                VARCHAR2(1000),
  id1_bf                     VARCHAR2(1000),
  participacion1_bf          VARCHAR2(1000),
  numero2_id_bf              VARCHAR2(1000),
  nombres2_bf                VARCHAR2(1000),
  nombre2_razonsocial_bf     VARCHAR2(1000),
  tipo2_id_bf                VARCHAR2(1000),
  id2_bf                     VARCHAR2(1000),
  participacion2_bf          VARCHAR2(1000),
  numero3_id_bf              VARCHAR2(1000),
  nombres3_bf                VARCHAR2(1000),
  nombre3_razonsocial_bf     VARCHAR2(1000),
  tipo3_id_bf                VARCHAR2(1000),
  id3_bf                     VARCHAR2(1000),
  participacion3_bf          VARCHAR2(1000),
  numero4_id_bf              VARCHAR2(1000),
  nombres4_bf                VARCHAR2(1000),
  nombre4_razonsocial_bf     VARCHAR2(1000),
  tipo4_id_bf                VARCHAR2(1000),
  id4_bf                     VARCHAR2(1000),
  participacion4_bf          VARCHAR2(1000),
  ingr_mensuales_if          VARCHAR2(1000),
  egr_mensuales_if           VARCHAR2(1000),
  activos_if                 VARCHAR2(1000),
  pasivos_if                 VARCHAR2(1000),
  patrimonio_if              VARCHAR2(1000),
  otros_ingresos_if          VARCHAR2(1000),
  con_otros_ing_if           VARCHAR2(1000),
  declaracion_fondos_df      VARCHAR2(1000),
  realiza_transacciones_oi   VARCHAR2(1000),
  si_cual_oi                 VARCHAR2(1000),
  otras_indi_oi              VARCHAR2(1000),
  posee_productos_oi         VARCHAR2(1000),
  poseee_cuentas_oi          VARCHAR2(1000),
  tipo_producto_ai           VARCHAR2(1000),
  iden_numero_producto_ai    VARCHAR2(1000),
  entidad_ai                 VARCHAR2(1000),
  monto_ai                   VARCHAR2(1000),
  pais_ai                    VARCHAR2(1000),
  departamento_ai            VARCHAR2(1000),
  ciudad_ai                  VARCHAR2(1000),
  moneda_ai                  VARCHAR2(1000),
  ha_present_rs              VARCHAR2(1000),
  ano_rs                     VARCHAR2(1000),
  ramo_rs                    VARCHAR2(1000),
  compania_rs                VARCHAR2(1000),
  valor_rs                   VARCHAR2(1000),
  resultado_rs               VARCHAR2(1000),
  autoriza_1_ca              VARCHAR2(1000),
  autoriza_2_ca              VARCHAR2(1000),
  estado_confirmacion_cf     VARCHAR2(1000),
  fecha_confirmacion_cf      VARCHAR2(1000),
  fecha_entrevista_ie        VARCHAR2(1000),
  resultado_ie               VARCHAR2(1000)
)
organization external
(
  type ORACLE_LOADER
  default directory TABEXT
  access parameters 
  (
    records delimited by 0x'0A'
     logfile 'Juridico 3.log'
     badfile 'Juridico 3.bad'
     discardfile 'Juridico 3.dis'
     fields terminated by '|' lrtrim
     MISSING FIELD VALUES ARE NULL
     REJECT ROWS WITH ALL NULL FIELDS
     (
        itomador,
        ntomador,
        fecha_dilimiento_cb,
        departamento_cb,
        ciudad_cb,
        sucursal_cb,
        tipo_solicitud_cb,
        clase_vin_cb,
        clase_otro_cb,
        residencia_sociedad_cb,
        tomador_aseg_cb,
        asegurado_otro_cb,
        tomador_bene_cb,
        beneficiario_otro_cb,
        asegu_beneficiario_cb,
        beneficiario_ase_otro_cb,
        nrazon_social_ib,
        tipo_documento_ib,
        nit_ib,
        dv_ib,
        tipo_empresa_ib,
        ciiu_acti_economica_ib,
        ciiu_cod_ib,
        sector_ib,
        direccion_oficina_ib,
        pais_oficina_ib,
        dep_oficina_ib,
        ciudad_oficina_ib,
        telefono_oficina_ib,
        email_ib,
        pais_sucursal_ib,
        depart_sucursal_ib,
        ciudad_sucursal_ib,
        direccion_sucursal_ib,
        telefono_sucursal_ib,
        primer_apellido_rl,
        segundo_apellido_rl,
        legal_nombres_rl,
        tipo_rl,
        numero_rl,
        fecha_exp_rl,
        pais_exped_rl,
        depart_exped_rl,
        lugar_exp_rl,
        fecha_naci_rl,
        pais_lugar_naci_rl,
        depart_lugar_naci_rl,
        lugar_naci_rl,
        naci_1rl,
        naci_2rl,
        email_rl,
        direccion_resid_rl,
        pais_resid_rl,
        departamento_resid_rl,
        ciudad_resid_rl,
        telefono_rl,
        celular_rl,
        algunos_rl,
        por_cargo_rl,
        es_usted_rl,       
        indique_cual_rl,
        a1_tipo_id,
        a1_numero_id,
        a1_nombres,
        a1_participacion,
        a1_espersona,
        a1_per_publicam,
        a1_sujeto,
        a2_tipo_id,
        a2_numero_id,
        a2_nombres,
        a2_participacion,
        a2_espersona,
        a2_per_publicam,
        a2_sujeto,
        a3_tipo_id,
        a3_numero_id,
        a3_nombres,
        a3_participacion,
        a3_espersona,
        a3_per_publicam,
        a3_sujeto,
        a4_tipo_id,
        a4_numero_id,
        a4_nombres,
        a4_participacion,
        a4_espersona,
        a4_per_publicam,
        a4_sujeto,
        a5_tipo_id,
        a5_numero_id,
        a5_nombres,
        a5_participacion,
        a5_espersona,
        a5_per_publicam,
        a5_sujeto,
        vinculo1_relacion_pep,
        nombre1_completo_pep,
        tipo1_identificacion_pep,
        numero1_identificacion_pep,
        nacionalidad1_pep,
        entidad1_pep,
        cargo1_pep,
        fecha1_desvinculacion_pep,
        vinculo2_relacion_pep,
        nombre2_completo_pep,
        tipo2_identificacion_pep,
        numero2_identificacion_pep,
        nacionalidad2_pep,
        entidad2_pep,
        cargo2_pep,
        fecha2_desvinculacion_pep,
        vinculo3_relacion_pep,
        nombre3_completo_pep,
        tipo3_identificacion_pep,
        numero3_identificacion_pep,
        nacionalidad3_pep,
        entidad3_pep,
        cargo3_pep,
        fecha3_desvinculacion_pep,
        vinculo4_relacion_pep,
        nombre4_completo_pep,
        tipo4_identificacion_pep,
        numero4_identificacion_pep,
        nacionalidad4_pep,
        entidad4_pep,
        cargo4_pep,
        fecha4_desvinculacion_pep,
        numero1_id_bf,
        nombres1_bf,
        nombre1_razonsocial_bf,
        tipo1_id_bf,
        id1_bf,
        participacion1_bf,
        numero2_id_bf,
        nombres2_bf,
        nombre2_razonsocial_bf,
        tipo2_id_bf,
        id2_bf,
        participacion2_bf,
        numero3_id_bf,
        nombres3_bf,
        nombre3_razonsocial_bf,
        tipo3_id_bf,
        id3_bf,
        participacion3_bf,
        numero4_id_bf,
        nombres4_bf,
        nombre4_razonsocial_bf,
        tipo4_id_bf,
        id4_bf,
        participacion4_bf,
        ingr_mensuales_if,
        egr_mensuales_if,
        activos_if,
        pasivos_if,
        patrimonio_if,
        otros_ingresos_if,
        con_otros_ing_if,
        declaracion_fondos_df,
        realiza_transacciones_oi,
        si_cual_oi,
        otras_indi_oi,
        posee_productos_oi,
        poseee_cuentas_oi,
        tipo_producto_ai,
        iden_numero_producto_ai,
        entidad_ai,
        monto_ai,
        pais_ai,
        departamento_ai,
        ciudad_ai,
        moneda_ai,
        ha_present_rs,
        ano_rs,
        ramo_rs,
        compania_rs,
        valor_rs,
        resultado_rs,
        autoriza_1_ca,
        autoriza_2_ca,
        estado_confirmacion_cf,
        fecha_confirmacion_cf,
		fecha_entrevista_ie,
		resultado_ie
    )
  )
  location (TABEXT:'Juridico 3.csv')
)
reject limit UNLIMITED;


alter table DATOS_SARLAF_J drop column cuales_rl;

alter table DATOS_SARLAF_J add FECHA_ENTREVISTA_IE VARCHAR2(1000);
alter table DATOS_SARLAF_J add RESULTADO_IE VARCHAR2(1000);

--Grant 
grant select on AXIS.DATOS_SARLAF_J_EXT to AXIS00;


-- Utilizar para crear synonym

create or replace synonym AXIS.DATOS_SARLAF_J_EXT for AXIS00.DATOS_SARLAF_J_EXT;
