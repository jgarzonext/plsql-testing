--------------------------------------------------------
--  DDL for Table INT_RGA_EXT
--------------------------------------------------------

  CREATE TABLE "AXIS"."INT_RGA_EXT" 
   (	"EMPRESA" NUMBER(2,0), 
	"PRODUCTO" VARCHAR2(6 BYTE), 
	"POLIZA_PARTICIPE" VARCHAR2(10 BYTE), 
	"NIF" VARCHAR2(14 BYTE), 
	"NOMBRE" VARCHAR2(100 BYTE), 
	"APELLIDOS" VARCHAR2(40 BYTE), 
	"DIRECCION" VARCHAR2(80 BYTE), 
	"CP" VARCHAR2(5 BYTE), 
	"POBLACION" VARCHAR2(40 BYTE), 
	"PROVINCIA" VARCHAR2(20 BYTE), 
	"FEC_NAC" DATE, 
	"CAJA_GESTORA" VARCHAR2(4 BYTE), 
	"CAJA_COBRADORA" VARCHAR2(4 BYTE), 
	"OFICINA_GESTORA" VARCHAR2(4 BYTE), 
	"OFICINA_COBRADORA" VARCHAR2(4 BYTE), 
	"EMPLEADO" VARCHAR2(4 BYTE), 
	"IMPORTE_EMITIDOS_PROD" VARCHAR2(15 BYTE), 
	"IMPORTE_ANULADOS_PROD" VARCHAR2(15 BYTE), 
	"IMPORTE_EMITIDOS_CART" VARCHAR2(15 BYTE), 
	"IMPORTE_ANULADOS_CART" VARCHAR2(15 BYTE), 
	"IMPORTE_EMITIDOS_RECUR" VARCHAR2(15 BYTE), 
	"IMPORTE_ANULADOS_RECUR" VARCHAR2(15 BYTE), 
	"NUM_REC_PRODUCCION_EMITIDOS" NUMBER(4,0), 
	"NUM_REC_PRODUCCION_ANULADOS" NUMBER(4,0), 
	"NUM_REC_CARTERA_EMITIDOS" NUMBER(4,0), 
	"NUM_REC_CARTERA_ANULADOS" NUMBER(4,0), 
	"NUM_REC_RECURRENTES_EMITIDOS" NUMBER(4,0), 
	"NUM_REC_RECURRENTES_ANULADOS" NUMBER(4,0), 
	"FORMA_PAGO" VARCHAR2(2 BYTE), 
	"TIPO" VARCHAR2(4 BYTE), 
	"COM_DEVENG_PRODUCCION_EMISION" VARCHAR2(15 BYTE), 
	"COM_DEVENG_PRODUCCION_ANULACI" VARCHAR2(15 BYTE), 
	"COM_DEVENG_CARTERA_EMISION" VARCHAR2(15 BYTE), 
	"COM_DEVENG_CARTERA_ANULACION" VARCHAR2(15 BYTE), 
	"COM_DEVENG_RECUR_EMISION" VARCHAR2(15 BYTE), 
	"COM_DEVENG_RECUR_ANULACION" VARCHAR2(15 BYTE), 
	"COM_PRODUCCION_COBROS" VARCHAR2(15 BYTE), 
	"COM_PRODUCCION_DEVOLUCIONES" VARCHAR2(15 BYTE), 
	"COM_CARTERA_COBROS" VARCHAR2(15 BYTE), 
	"COM_CARTERA_DEVOLUCIONES" VARCHAR2(15 BYTE), 
	"IMPORTE_DESCUENTO_OM" VARCHAR2(15 BYTE), 
	"FEC_CONTRATACION" DATE, 
	"FEC_EFECTO" DATE, 
	"FEC_VENCIMIENTO" DATE, 
	"FEC_ANULACION" DATE, 
	"FEC_INICIO_PERIODO" DATE, 
	"FEC_FIN_PERIODO" DATE, 
	"NUM_SINIESTROS" NUMBER(4,0), 
	"IMPORTE_PAGOS" VARCHAR2(15 BYTE), 
	"PRIMA_NETA_ANUALIZADA" VARCHAR2(15 BYTE), 
	"PROVISION_MATEMATICA" VARCHAR2(15 BYTE), 
	"NUM_PARTIPACIONES" VARCHAR2(15 BYTE), 
	"VALOR_PARTICIPACION" VARCHAR2(15 BYTE), 
	"COMISION_RESPU" VARCHAR2(15 BYTE), 
	"CUENTA_CORRIENTE" VARCHAR2(20 BYTE), 
	"POLIZA_ASEGURADORA" VARCHAR2(20 BYTE), 
	"CIA_ASEGURADORA" VARCHAR2(6 BYTE), 
	"BENEFICIARIO" VARCHAR2(126 BYTE), 
	"AGRU1" VARCHAR2(60 BYTE), 
	"AGRU2" VARCHAR2(80 BYTE), 
	"IMPORTE_PRIMA_UNICA" VARCHAR2(15 BYTE), 
	"APORT_PROMOTOR_EXT" VARCHAR2(15 BYTE), 
	"ANUL_APORT_PROMOTOR_EXT" VARCHAR2(15 BYTE), 
	"TRASPASOS_ENTRADA" VARCHAR2(15 BYTE), 
	"TRASPASOS_SALIDA" VARCHAR2(15 BYTE), 
	"TRASPASOS_INTERNOS_ENT" VARCHAR2(15 BYTE), 
	"TRASPASOS_INTERNOS_SAL" VARCHAR2(15 BYTE), 
	"INVERCO" VARCHAR2(30 BYTE), 
	"NIF_TOMADOR" VARCHAR2(14 BYTE), 
	"NOMBRE_TOMADOR" VARCHAR2(100 BYTE), 
	"APELLIDOS_TOMADOR" VARCHAR2(40 BYTE), 
	"DIRECCION_TOMADOR" VARCHAR2(80 BYTE), 
	"CP_TOMADOR" VARCHAR2(5 BYTE), 
	"POBLACION_TOMADOR" VARCHAR2(40 BYTE), 
	"PROVINCIA_TOMADOR" VARCHAR2(20 BYTE), 
	"FEC_NAC_TOMADOR" DATE, 
	"IMPORTE_VALOR_RESCATE" VARCHAR2(15 BYTE), 
	"IMPORTE_PB" VARCHAR2(15 BYTE), 
	"IMPORTE_FACTURACION_ACUMULADA" VARCHAR2(15 BYTE), 
	"MOTIVO_ANULACION" VARCHAR2(60 BYTE), 
	"IMP_PRESTA_PENSIONES_CAPITAL" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_PENS_RENT_FINANCIE" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_PENS_A_VIDA" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_PENS_DE_VIDA" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_PENS_RENT_ASEGURAD" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_PENS_RETENCIONES" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_VIDA_SINIESTROS" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_VIDA_VENCIMIENTOS" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_VIDA_RESCATES" VARCHAR2(15 BYTE), 
	"IMP_PRESTA_VIDA_RENTAS" VARCHAR2(15 BYTE), 
	"IMP_CAPITAL_FINAL_VIDA" VARCHAR2(15 BYTE), 
	"CAPITAL_ASEGURADO" VARCHAR2(15 BYTE), 
	"NUM_SINIESTROS_PENDIENTES" NUMBER(4,0), 
	"NUM_SINIESTROS_CERRADOS" NUMBER(4,0), 
	"CAPITAL_2" VARCHAR2(15 BYTE), 
	"CAPITAL_3" VARCHAR2(15 BYTE), 
	"CAPITAL_4" VARCHAR2(15 BYTE), 
	"CAPITAL_5" VARCHAR2(15 BYTE), 
	"IMPORTE_CALENDARIO" VARCHAR2(15 BYTE), 
	"IMP_APORT_EXTRAORD_NETA" VARCHAR2(15 BYTE), 
	"IMP_FACT_CASADA_NETA" VARCHAR2(15 BYTE), 
	"TRASPASO_ENTRADA_RGA" VARCHAR2(15 BYTE), 
	"TRASPASO_SALIDA_RGA" VARCHAR2(15 BYTE)
   ) 
   ORGANIZATION EXTERNAL 
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY "AXIS_PLANTILLAS"
      ACCESS PARAMETERS
      ( records delimited by newline
                   skip 1
                   logfile 'Mensual 04-2010.log'
                   badfile 'Mensual 04-2010.bad'
                   discardfile 'Mensual 04-2010.dis'
                   fields terminated by '|'
                   MISSING FIELD VALUES ARE NULL
                   REJECT ROWS WITH ALL NULL FIELDS
                   ( EMPRESA,
                     PRODUCTO,
                     POLIZA_PARTICIPE,
                     NIF,
                     NOMBRE,
                     APELLIDOS,
                     DIRECCION,
                     CP   ,
                     POBLACION ,
                     PROVINCIA  ,
                     FEC_NAC  DATE MASK "dd-mm-yyyy",
                     CAJA_GESTORA ,
                     CAJA_COBRADORA,
                     OFICINA_GESTORA  ,
                     OFICINA_COBRADORA ,
                     EMPLEADO    ,
                     IMPORTE_EMITIDOS_PROD ,
                     IMPORTE_ANULADOS_PROD ,
                     IMPORTE_EMITIDOS_CART ,
                     IMPORTE_ANULADOS_CART ,
                     IMPORTE_EMITIDOS_RECUR ,
                     IMPORTE_ANULADOS_RECUR,
                     NUM_REC_PRODUCCION_EMITIDOS ,
                     NUM_REC_PRODUCCION_ANULADOS,
                     NUM_REC_CARTERA_EMITIDOS,
                     NUM_REC_CARTERA_ANULADOS ,
                     NUM_REC_RECURRENTES_EMITIDOS ,
                     NUM_REC_RECURRENTES_ANULADOS,
                     FORMA_PAGO ,
                     TIPO,
                     COM_DEVENG_PRODUCCION_EMISION ,
                     COM_DEVENG_PRODUCCION_ANULACI,
                     COM_DEVENG_CARTERA_EMISION ,
                     COM_DEVENG_CARTERA_ANULACION,
                     COM_DEVENG_RECUR_EMISION  ,
                     COM_DEVENG_RECUR_ANULACION  ,
                     COM_PRODUCCION_COBROS,
                     COM_PRODUCCION_DEVOLUCIONES  ,
                     COM_CARTERA_COBROS  ,
                     COM_CARTERA_DEVOLUCIONES ,
                     IMPORTE_DESCUENTO_OM,
                     FEC_CONTRATACION DATE MASK "dd-mm-yyyy",
                     FEC_EFECTO   DATE MASK "dd-mm-yyyy",
                     FEC_VENCIMIENTO  DATE MASK "dd-mm-yyyy",
                     FEC_ANULACION  DATE MASK "dd-mm-yyyy",
                     FEC_INICIO_PERIODO  DATE MASK "dd-mm-yyyy",
                     FEC_FIN_PERIODO  DATE MASK "dd-mm-yyyy",
                     NUM_SINIESTROS ,
                     IMPORTE_PAGOS ,
                     PRIMA_NETA_ANUALIZADA,
                     PROVISION_MATEMATICA ,
                     NUM_PARTIPACIONES ,
                     VALOR_PARTICIPACION ,
                     COMISION_RESPU ,
                     CUENTA_CORRIENTE ,
                     POLIZA_ASEGURADORA,
                     CIA_ASEGURADORA ,
                     BENEFICIARIO,
                     AGRU1 ,
                     AGRU2 ,
                     IMPORTE_PRIMA_UNICA  ,
                     APORT_PROMOTOR_EXT ,
                     ANUL_APORT_PROMOTOR_EXT  ,
                     TRASPASOS_ENTRADA  ,
                     TRASPASOS_SALIDA ,
                     TRASPASOS_INTERNOS_ENT  ,
                     TRASPASOS_INTERNOS_SAL ,
                     INVERCO  ,
                     NIF_TOMADOR   ,
                     NOMBRE_TOMADOR ,
                     APELLIDOS_TOMADOR  ,
                     DIRECCION_TOMADOR ,
                     CP_TOMADOR   ,
                     POBLACION_TOMADOR ,
                     PROVINCIA_TOMADOR ,
                     FEC_NAC_TOMADOR  DATE MASK "dd-mm-yyyy",
                     IMPORTE_VALOR_RESCATE  ,
                     IMPORTE_PB       ,
                     IMPORTE_FACTURACION_ACUMULADA ,
                     MOTIVO_ANULACION  ,
                     IMP_PRESTA_PENSIONES_CAPITAL ,
                     IMP_PRESTA_PENS_RENT_FINANCIE ,
                     IMP_PRESTA_PENS_A_VIDA ,
                     IMP_PRESTA_PENS_DE_VIDA ,
                     IMP_PRESTA_PENS_RENT_ASEGURAD ,
                     IMP_PRESTA_PENS_RETENCIONES,
                     IMP_PRESTA_VIDA_SINIESTROS ,
                     IMP_PRESTA_VIDA_VENCIMIENTOS ,
                     IMP_PRESTA_VIDA_RESCATES ,
                     IMP_PRESTA_VIDA_RENTAS  ,
                     IMP_CAPITAL_FINAL_VIDA ,
                     CAPITAL_ASEGURADO    ,
                     NUM_SINIESTROS_PENDIENTES  ,
                     NUM_SINIESTROS_CERRADOS  ,
                     CAPITAL_2,
                     CAPITAL_3,
                     CAPITAL_4,
                     CAPITAL_5 ,
                     IMPORTE_CALENDARIO
                  )                                              )
      LOCATION
       ( "AXIS_PLANTILLAS":'Mensual 04-2010.txt'
       )
    )
   REJECT LIMIT 1 ;
  GRANT SELECT ON "AXIS"."INT_RGA_EXT" TO "PROGRAMADORESCSI";
  GRANT SELECT ON "AXIS"."INT_RGA_EXT" TO "R_AXIS";
  GRANT SELECT ON "AXIS"."INT_RGA_EXT" TO "CONF_DWH";
