--------------------------------------------------------
--  DDL for Function F_DESASEGURADO
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "AXIS"."F_DESASEGURADO" (PSSEGURO IN NUMBER, PIDIOMA IN NUMBER,
PTEXTO IN OUT VARCHAR2)
RETURN VARCHAR2 authid current_user IS
/******************************************************************
	F_DESASEGURADO
******************************************************************/
	ASEGUR	NUMBER;
BEGIN
	BEGIN
		SELECT CASEGUR,TASEGUR
		INTO ASEGUR,PTEXTO
		FROM SEGUROS
		WHERE  SSEGURO=PSSEGURO;
	EXCEPTION
		WHEN NO_DATA_FOUND THEN
			RETURN 103286;		--EL SEGURO NO EXISTE
		WHEN OTHERS THEN
			RETURN 101919;		--ERROR EN TABLA SEGUROS
	END;
	IF ASEGUR=0 THEN
		RETURN 0;
	ELSE
		BEGIN
			SELECT TASEGUR
			INTO PTEXTO
			FROM DESASEGURADO
			WHERE CASEGUR=ASEGUR
			  AND CIDIOMA=PIDIOMA;
		EXCEPTION
			WHEN NO_DATA_FOUND THEN
				RETURN 103287;		--NO EXISTE LA
							--DESCRIPCIÓN DEL ASEGURADO
			WHEN OTHERS THEN
				RETURN 103285;	--ERROR EN TABLA DESASEGURADO
		END;
		RETURN 0;
	END IF;
END;
 
 

/

  GRANT EXECUTE ON "AXIS"."F_DESASEGURADO" TO "R_AXIS";
  GRANT EXECUTE ON "AXIS"."F_DESASEGURADO" TO "CONF_DWH";
  GRANT EXECUTE ON "AXIS"."F_DESASEGURADO" TO "PROGRAMADORESCSI";
