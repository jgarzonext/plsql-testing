--------------------------------------------------------
--  DDL for Function F_BUSCAR_POL_CERT
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "AXIS"."F_BUSCAR_POL_CERT" (SOLICI IN NUMBER, POLIZA OUT NUMBER, CERTIF OUT NUMBER) RETURN NUMBER IS

BEGIN
    SELECT NPOLIZA, NCERTIF
    INTO POLIZA,CERTIF
    FROM SEGUROS
    WHERE NSOLICI = SOLICI;
    RETURN 0;

	EXCEPTION
        WHEN NO_DATA_FOUND THEN
          RETURN 102374;      -- COBRADOR BANCARI NO TROBAT A COBBANCARIO
        WHEN TOO_MANY_ROWS THEN
          RETURN 102552;      -- REGISTRE DUPLICAT A COBBANCARIO
        WHEN OTHERS THEN
          RETURN 103941;      -- ERROR AL LLEGIR LA TAULA COBBANCARIO
        END;

 
 

/

  GRANT EXECUTE ON "AXIS"."F_BUSCAR_POL_CERT" TO "CONF_DWH";
  GRANT EXECUTE ON "AXIS"."F_BUSCAR_POL_CERT" TO "PROGRAMADORESCSI";
  GRANT EXECUTE ON "AXIS"."F_BUSCAR_POL_CERT" TO "R_AXIS";
