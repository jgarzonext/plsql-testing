--------------------------------------------------------
--  DDL for Function F_SUBLINEA
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "AXIS"."F_SUBLINEA" ( LINEA_VAR IN VARCHAR
	   	  		  		   			  , DESDE IN NUMBER
									  , LARGO IN NUMBER ) RETURN VARCHAR IS
  PCOMA NUMBER;
BEGIN

  PCOMA := INSTR(SUBSTR(LINEA_VAR,DESDE,LARGO),';',1);
  IF PCOMA > 0 THEN
  --	MESSAGE ( 'LINEA ' || LINEA_VAR );PAUSE;
  	RETURN SUBSTR(SUBSTR(LINEA_VAR,DESDE,LARGO),1,PCOMA-1);
  ELSE
    RETURN SUBSTR(LINEA_VAR,DESDE,LARGO);
  END IF;

EXCEPTION
	WHEN OTHERS THEN
	 RETURN NULL;
END F_SUBLINEA;

 
 

/

  GRANT EXECUTE ON "AXIS"."F_SUBLINEA" TO "R_AXIS";
  GRANT EXECUTE ON "AXIS"."F_SUBLINEA" TO "CONF_DWH";
  GRANT EXECUTE ON "AXIS"."F_SUBLINEA" TO "PROGRAMADORESCSI";
