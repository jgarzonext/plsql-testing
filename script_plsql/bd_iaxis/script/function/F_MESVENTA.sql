--------------------------------------------------------
--  DDL for Function F_MESVENTA
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "AXIS"."F_MESVENTA" (PTIPO IN NUMBER, PFEMISIO IN DATE, PFEFECTO IN DATE, PFCIERRE IN DATE)
RETURN NUMBER authid current_user IS
BEGIN
-- Nova producció
IF PTIPO = 0 THEN
IF PFEMISIO < PFCIERRE THEN
RETURN TO_NUMBER(TO_CHAR(PFEFECTO,'YYYYMM'));
ELSE
RETURN TO_NUMBER(TO_CHAR(PFEMISIO,'YYYYMM'));
END IF;
END IF;
-- Suplements
IF PTIPO = 1 THEN
IF PFEFECTO > PFEMISIO THEN
RETURN TO_NUMBER(TO_CHAR(PFEFECTO,'YYYYMM'));
ELSE
RETURN TO_NUMBER(TO_CHAR(PFEMISIO,'YYYYMM'));
END IF;
END IF;
-- Renovacions
IF PTIPO = 3 THEN
RETURN TO_NUMBER(TO_CHAR(PFEFECTO,'YYYYMM'));
END IF;
-- Extorns
IF PTIPO = 9 THEN
RETURN TO_NUMBER(TO_CHAR(PFEMISIO,'YYYYMM'));
END IF;
RETURN 0;
END;

 
 

/

  GRANT EXECUTE ON "AXIS"."F_MESVENTA" TO "R_AXIS";
  GRANT EXECUTE ON "AXIS"."F_MESVENTA" TO "CONF_DWH";
  GRANT EXECUTE ON "AXIS"."F_MESVENTA" TO "PROGRAMADORESCSI";
