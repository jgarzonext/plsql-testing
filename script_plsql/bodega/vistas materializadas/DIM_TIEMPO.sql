----- DELETE VISTA ----------	
BEGIN
    PAC_SKIP_ORA.p_comprovadrop('DIM_TIEMPO','MATERIALIZED VIEW');  
END;
/
----- CREATE VISTA ----------
CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_TIEMPO" ("TIE_ID", "TIE_ANO", "TIE_TRIMESTRE", "TIE_MES", "TIE_DIA", "TIE_FECHA", "TIE_MES_DESC", 
 "TIE_SEMANA", "TIE_DIA_DESC", "FECHA_REGISTRO", "ESTADO", "START_ESTADO", "END_ESTADO", "FECHA_CONTROL", "FECHA_INICIAL", "FECHA_FIN")
ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
NOCOMPRESS LOGGING
STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "CONF_DWH"   NO INMEMORY 
BUILD IMMEDIATE
USING INDEX 
REFRESH COMPLETE ON DEMAND START WITH SYSDATE+0 NEXT SYSDATE + 1
USING DEFAULT LOCAL ROLLBACK SEGMENT
USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
AS SELECT TIE_ID,
TIE_ANO,
TIE_TRIMESTRE, 
TIE_MES, 
TIE_DIA, 
TIE_FECHA, 
TIE_MES_DESC, 
TIE_SEMANA, 
TIE_DIA_DESC, 
FECHA_REGISTRO, 
ESTADO, 
START_ESTADO, 
END_ESTADO, 
FECHA_CONTROL, 
FECHA_INICIAL, 
FECHA_FIN
FROM DIM_TIEMPO@BODEGA;

COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_TIEMPO"  IS 'snapshot table for snapshot DWH_CONF.DIM_TIEMPO';
