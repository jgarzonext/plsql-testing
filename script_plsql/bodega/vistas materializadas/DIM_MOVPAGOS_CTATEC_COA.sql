--------------------------------------------------------
--  DDL for Materialized View DIM_MOVPAGOS_CTATEC_COA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_MOVPAGOS_CTATEC_COA" ("SMOVPAGCOA", "SPAGCOA", "CCOMPANI", "ESTADO_ANTERIOR", "ESTADO", "IIMPORTE", "IIMPORTE_MONCON")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 0 INITRANS 2 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  BUILD IMMEDIATE
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  REFRESH FORCE ON DEMAND START WITH sysdate+0 NEXT TRUNC(SYSDATE + 1) + 20/24
  WITH PRIMARY KEY USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS select smovpagcoa, spagcoa, ccompani,
      decode(cestant,0,'Pendiente',1,'Pagado',2,'Retenido') estado_anterior,
      decode(cestado,0,'Pendiente',1,'Pagado',2,'Retenido') estado, iimporte, iimporte_moncon
FROM MOVPAGOS_CTATEC_COA 
;

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_MOVPAGOS_CTATEC_COA"  IS 'snapshot table for snapshot CONF_DWH.DIM_MOVPAGOS_CTATEC_COA';
