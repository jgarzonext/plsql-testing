--------------------------------------------------------
--  DDL for Materialized View DIM_DETRECIBOS
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_DETRECIBOS" ("NRECIBO", "CCONCEP", "TCONCEP", "ICONCEP", "MONEDA_PRO", "ICONCEP_MONPOL", "MONEDA_CON")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 0 INITRANS 2 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND START WITH sysdate+0 NEXT TRUNC(SYSDATE + 1) + 20/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS select d.nrecibo, cconcep, ff_desvalorfijo(27,8, cconcep) tconcep, iconcep, m.cmonint moneda_pro, iconcep_monpol,m2.cmonint moneda_con
FROM   DETRECIBOS D, RECIBOS R, SEGUROS S, MONEDAS M, MONEDAS M2, PRODUCTOS P
where r.nrecibo = d.nrecibo
and s.sseguro = r.sseguro
and p.cdivisa = m.cmoneda
and m.cidioma = 8
and p.sproduc = s.sproduc
AND M2.CMONEDA = PAC_PARAMETROS.F_PAREMPRESA_N (R.CEMPRES, 'MONEDACONTAB') 
AND M2.CIDIOMA = 8;

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_DETRECIBOS"  IS 'snapshot table for snapshot CONF_DWH.DIM_DETRECIBOS';
