----- DELETE VISTA ----------
BEGIN
    PAC_SKIP_ORA.p_comprovadrop('DIM_TERCEROS','MATERIALIZED VIEW');  
END;
/

----- CREATE VISTA ----------
CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_TERCEROS" ("TERCERO_ID", "TER_ROLE_TERCERO", "TER_NOM_TERCERO", "TER_DOC_IDENT", "TER_NUM_DOC_IDENT", "TER_CODROL", "FECHA_REGISTRO", "ESTADO", "TER_PERSONA")
ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
NOCOMPRESS LOGGING
STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "CONF_DWH"   NO INMEMORY 
BUILD IMMEDIATE
USING INDEX 
REFRESH COMPLETE ON DEMAND START WITH SYSDATE+0 NEXT SYSDATE + 1
USING DEFAULT LOCAL ROLLBACK SEGMENT
USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
AS SELECT ROWNUM TERCERO_ID,
AXIS.FF_DESVALORFIJO(321, 8, S.CTIPDEC) TER_ROLE_TERCERO, 
S.TNOMDEC||' '||S.TAPE1DEC||' '||S.TAPE2DEC  TER_NOM_TERCERO,
AXIS.FF_DESVALORFIJO(672, 8, P.CTIPIDE) TER_DOC_IDENT,
P.NNUMIDE TER_NUM_DOC_IDENT, 
' ' TER_CODROL, 
AXIS.F_SYSDATE FECHA_REGISTRO,
'ACTIVO' ESTADO, 
P.SPERSON TER_PERSONA
FROM AXIS.SIN_SINIESTRO S, AXIS.PER_PERSONAS P
WHERE S.DEC_SPERSON = P.SPERSON
;

COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_TERCEROS"  IS 'SNAPSHOT TABLE FOR SNAPSHOT DWH_CONF.DIM_TERCEROS';