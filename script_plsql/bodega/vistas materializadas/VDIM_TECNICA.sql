--------------------------------------------------------
--  DDL for Materialized View VDIM_TECNICA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CONF_DWH"."VDIM_TECNICA" ("RAMO", "RAMO_DESC", "SUBRAMO", "SUBRAMO_DESC", "PRODUCTO", "SUBPRODUCTO", "SUBPRODUCTO_DESC", "COBERTURA", "COBERTURA_DESC", "FECHA_REGISTRO", "ESTADO", "START_ESTADO", "END_ESTADO", "FECHA_CONTROL", "FECHA_INICIAL", "FECHA_FIN")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 0 INITRANS 2 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS select 
       R.CRAMO RAMO,
       R.TRAMO RAMO_DESC,
       ' ' SUBRAMO,
       ' ' SUBRAMO_DESC,
       P.SPRODUC PRODUCTO,
       P.CSUBPRO SUBPRODUCTO,
       f_desproducto_t(p.cramo, p.cmodali, p.ctipseg, p.ccolect, 1, r.cidioma) SUBPRODUCTO_DESC,
       G.CGARANT COBERTURA,  GEN.TGARANT COBERTURA_DESC, 
       f_sysdate FECHA_REGISTRO, 'ACTIVO' ESTADO,
       to_date('01/01/1986') START_ESTADO, ' ' END_ESTADO,
       f_sysdate FECHA_CONTROL, TRUNC(f_sysdate, 'month') FECHA_INICIAL,
       trunc(last_day(sysdate)) FECHA_FIN
       FROM RAMOS R, PRODUCTOS P, GARANPRO G, GARANGEN GEN--, SEGUROS S
       WHERE R.CRAMO   = P.CRAMO 
         AND P.CRAMO   = G.CRAMO
         AND P.cmodali = g.cmodali
         and p.ctipseg = g.ctipseg
         and p.ccolect = g.ccolect
         AND G.CGARANT = GEN.CGARANT
         AND R.CIDIOMA = 8
         AND R.CIDIOMA = GEN.CIDIOMA;

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."VDIM_TECNICA"  IS 'snapshot table for snapshot CONF_DWH.VDIM_TECNICA';
