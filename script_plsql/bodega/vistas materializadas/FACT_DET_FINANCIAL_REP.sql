--------------------------------------------------------
--  DDL for Materialized View FACT_DET_FINANCIAL_REP
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CONF_DWH"."FACT_DET_FINANCIAL_REP" ("FR_SUCUR", "NOMBRE_SUCUR", "AGENCIA", "NOMBRE_AGENCIA", "POLIZA", "CERTIF", "TIPCER", "CODRAM", "NOMRAMO", "CODPLA", "NOMBRE_PRODUCTO", "CODCOB", "NOMBRE_AMPARO", "TIPCOA", "PORCENTAJE_COASEG", "FECINI", "FECFIN", "FECEXP", "FECINI_GRAL", "CODMONEDA", "MONEDA", "TRM", "VLR_ASEG_$", "VLR_ASEG_ME", "VLR_PRIMA_$", "VLR_PRIMA_ME", "PAQUETE", "PORC_RET1", "RETENCION_PRIORIDAD", "PORC_CTA", "CTA", "PORC_CUOTA2", "CUOTA2", "PORC_FAC", "FAC", "RETENCIA_CIA", "EXTERIOR", "INTERIOR", "CESION_TOTAL", "VALOR_COMISION_REASEGURO", "CESION_SWISS_RE", "VALOR_COMISION_SWISS_RE", "TIPO_CORRETAJE", "PORC_COMISION_INT", "VALOR_COMISION_INTERMEDIARIO", "PART_NEG", "NIT_INT_PPAL", "NOM_INTE_PPAL", "DEPTO_EJECUCION", "SECTORECONOMIA", "TIPO_TOMADOR", "MUNICIPIO_DE_EJECUCION", "CIIU_TOMADOR", "NIT_TOMADOR", "NOMBRE_TOMADOR", "NIT_ASEGURADO", "NOMBRE_ASEGURADO", "NITBEN", "NOM_BEN", "SUCMOD", "BUREAU", "FR_NOMCTORET", "FR_NOMCTOCTA", "FR_NOMCTOCTA2", "FR_CESSWCTA1", "FR_COMSWCTA1", "FR_CESSWCTA2", "FR_COMSWCTA2", "PRIMCEDCOA", "CORTE", "MES", "CONTABLE", "FR_PORCUO3", "FR_CUOTA3", "FR_CESSWCTA3", "FR_COMSWCTA3", "FR_FECSOL")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 0 INITRANS 2 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS SELECT FR_SUCUR, NOMBRE_SUCUR, AGENCIA, NOMBRE_AGENCIA, POLIZA, CERTIF, TIPCER, CODRAM, NOMRAMO, CODPLA,
   NOMBRE_PRODUCTO, CODCOB, NOMBRE_AMPARO, TIPCOA, PORCENTAJE_COASEG, FECINI, FECFIN, FECEXP, FECINI_GRAL, 
   CODMONEDA, MONEDA, TRM, VLR_ASEG_$, VLR_ASEG_ME,
   VLR_PRIMA_$, VLR_PRIMA_ME, cast(PAQUETE as VARCHAR2(10)) PAQUETE, PORC_RET1, RETENCION_PRIORIDAD, PORC_CTA, CTA, PORC_CUOTA2, CUOTA2,
   PORC_FAC, FAC, RETENCIA_CIA, cast(EXTERIOR as number) EXTERIOR, cast(INTERIOR as number) INTERIOR, cast(CESION_TOTAL as number)CESION_TOTAL, 
   cast(VALOR_COMISION_REASEGURO as number)VALOR_COMISION_REASEGURO , cast(CESION_SWISS_RE as number)CESION_SWISS_RE,
   cast(VALOR_COMISION_SWISS_RE as number)VALOR_COMISION_SWISS_RE, TIPO_CORRETAJE, cast(PORC_COMISION_INT as number)PORC_COMISION_INT,
   cast(VALOR_COMISION_INTERMEDIARIO as number) VALOR_COMISION_INTERMEDIARIO, cast(PART_NEG as number)PART_NEG, NIT_INT_PPAL,
   NOM_INTE_PPAL, DEPTO_EJECUCION, SECTORECONOMIA, TIPO_TOMADOR, MUNICIPIO_DE_EJECUCION, CIIU_TOMADOR, NIT_TOMADOR, 
   NOMBRE_TOMADOR, NIT_ASEGURADO, NOMBRE_ASEGURADO, NITBEN, NOM_BEN, SUCMOD, BUREAU, FR_NOMCTORET, FR_NOMCTOCTA, 
   FR_NOMCTOCTA2, FR_CESSWCTA1, FR_COMSWCTA1, FR_CESSWCTA2, FR_COMSWCTA2, ICEDNET PRIMCEDCOA, CORTE, MES, CONTABLE,
   FR_PORCUO3, FR_CUOTA3, FR_CESSWCTA3, FR_COMSWCTA3, FR_FECSOL
   FROM "DWH_CONF"."FACT_DET_FINANCIAL_PRUEBA";

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."FACT_DET_FINANCIAL_REP"  IS 'snapshot table for snapshot DWH_CONF.FACT_DET_FINANCIAL_REP';
