----- DELETE VISTA ----------
BEGIN
    PAC_SKIP_ORA.p_comprovadrop('DIM_PREMIOS_CONCURSO','MATERIALIZED VIEW');  
END;
/

----- CREATE VISTA ----------
  CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_PREMIOS_CONCURSO" ("PCONC_ID", "PCONC_RANGO_INF", "PCONC_CANTIDAD_PREMIO", "PCONC_CATEGORIA", "PCONC_TIPO_PREMIO", 
  "PCONC_FK_CONCURSO", "FECHA_REGISTRO", "ESTADO", "START_ESTADO", "END_ESTADO", "FECHA_CONTROL", "FECHA_INICIAL", "FECHA_FIN", "PCONC_PREMIO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
NOCOMPRESS LOGGING
STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "CONF_DWH"   NO INMEMORY 
BUILD IMMEDIATE
USING INDEX 
REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1
USING DEFAULT LOCAL ROLLBACK SEGMENT
USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS SELECT SEQ_PCONC_ID.NEXTVAL@BODEGA PCONC_ID, 
c.IVALINI PCONC_RANGO_INF, 
c.NAGECAM PCONC_CANTIDAD_PREMIO, 
c.TOBSERV PCONC_CATEGORIA, 
C.IPREMIO PCONC_TIPO_PREMIO, 
C.CCODIGO PCONC_FK_CONCURSO,
AXIS.F_SYSDATE FECHA_REGISTRO,
'ACTIVO' ESTADO,
TO_DATE('01/01/1986') START_ESTADO,
AXIS.F_SYSDATE END_ESTADO,
AXIS.F_SYSDATE FECHA_CONTROL,
TRUNC(AXIS.F_SYSDATE, 'month') FECHA_INICIAL,
TRUNC(LAST_DAY(AXIS.F_SYSDATE)) FECHA_FIN,
c.ccodigo PCONC_PREMIO
FROM AXIS.campanas c;

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_PREMIOS_CONCURSO"  IS 'snapshot table for snapshot DWH_CONF.DIM_PREMIOS_CONCURSO';
   
