--------------------------------------------------------
--  DDL for Materialized View DIM_ASEGURADORA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CONF_DWH"."DIM_ASEGURADORA" ("ASG_NIT", "ASG_DESC", "FECHA_REGISTRO", "ESTADO", "START_ESTADO", "END_ESTADO", "FECHA_CONTROL", "FECHA_INICIAL", "FECHA_FIN")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 0 INITRANS 2 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "CONF_DWH" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
  AS SELECT p.NNUMIDE ASG_NIT,
  d.tnombre||' '||d.tapelli1||' '||d.tapelli2 ASG_DESC,
  f_sysdate FECHA_REGISTRO,
  'ACTIVO' ESTADO,
  to_date('01/01/1986') START_ESTADO,
  ' ' END_ESTADO,
  f_sysdate FECHA_CONTROL,
  TRUNC(f_sysdate, 'month') FECHA_INICIAL,
  trunc(last_day(sysdate))FECHA_FIN
FROM aseguradoras a,
  per_personas p,per_detper d
WHERE a.sperson = p.sperson
and p.sperson = d.sperson
AND ctipide     = 37;

   COMMENT ON MATERIALIZED VIEW "CONF_DWH"."DIM_ASEGURADORA"  IS 'snapshot table for snapshot DWH_CONF.DIM_ASEGURADORA';
